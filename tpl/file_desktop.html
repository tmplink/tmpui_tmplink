<link rel="stylesheet" href="/css/file.css?v=1">
<script src="/js/file.js?v=1"></script>

<div class="file-screen" id="file_screen">
    <header class="file-header">
        <a class="file-logo" href="/">
            <img id="top_loggo" src="/img/loading.svg" alt="tmp.link">
        </a>
        <div class="file-header-actions" id="index_lang" style="display: none;">
            <button class="lang-chip hs-enabled" type="button" style="display: none;">
                <iconpark-icon name="gauge-circle-bolt"></iconpark-icon>
                <span i18n="hs_enabled">.</span>
            </button>
            <button class="lang-chip showOpenInMenubarX" type="button" onclick="filePage.openInMenubarXofIndex()" style="display: none;">
                <img src="/img/menubarx/icon.svg" alt="menubarx" />
                <span i18n="open_in_menubarx">.</span>
            </button>
            <div class="file-dropdown">
                <button class="lang-toggle file-dropdown-toggle" type="button" onclick="fileUI.toggleDropdown(this)">
                    <iconpark-icon name="language"></iconpark-icon>
                    <span class="selected_lang">Language/语言</span>
                </button>
                <div class="file-dropdown-menu file-dropdown-menu-right">
                    <a class="file-dropdown-item" href="javascript:void(0)" onclick="TL.language('cn');fileUI.closeDropdowns();">简体中文</a>
                    <a class="file-dropdown-item" href="javascript:void(0)" onclick="TL.language('hk');fileUI.closeDropdowns();">繁体中文</a>
                    <a class="file-dropdown-item" href="javascript:void(0)" onclick="TL.language('en');fileUI.closeDropdowns();">English</a>
                    <a class="file-dropdown-item" href="javascript:void(0)" onclick="TL.language('jp');fileUI.closeDropdowns();">日本語</a>
                </div>
            </div>
        </div>
    </header>

    <section class="file-body">
        <!-- Skeleton Loading Screen -->
        <div id="file_skeleton" class="skeleton-card">
            <div class="skeleton-info-panel">
                <div class="skeleton-icon"></div>
                <div class="skeleton-title skeleton-bone"></div>
                <div class="skeleton-meta">
                    <div class="skeleton-meta-item skeleton-bone"></div>
                    <div class="skeleton-meta-item skeleton-bone"></div>
                    <div class="skeleton-meta-item skeleton-bone"></div>
                </div>
                <div class="skeleton-publisher">
                    <div class="skeleton-avatar skeleton-bone"></div>
                    <div class="skeleton-publisher-info">
                        <div class="skeleton-name skeleton-bone"></div>
                        <div class="skeleton-intro skeleton-bone"></div>
                    </div>
                </div>
            </div>
            <div class="skeleton-action-panel">
                <div class="skeleton-btn-container">
                    <div class="skeleton-btn"></div>
                </div>
                <div class="skeleton-actions-grid">
                    <div class="skeleton-action-item">
                        <div class="skeleton-action-icon"></div>
                        <div class="skeleton-action-label skeleton-bone"></div>
                    </div>
                    <div class="skeleton-action-item">
                        <div class="skeleton-action-icon"></div>
                        <div class="skeleton-action-label skeleton-bone"></div>
                    </div>
                    <div class="skeleton-action-item">
                        <div class="skeleton-action-icon"></div>
                        <div class="skeleton-action-label skeleton-bone"></div>
                    </div>
                    <div class="skeleton-action-item">
                        <div class="skeleton-action-icon"></div>
                        <div class="skeleton-action-label skeleton-bone"></div>
                    </div>
                    <div class="skeleton-action-item">
                        <div class="skeleton-action-icon"></div>
                        <div class="skeleton-action-label skeleton-bone"></div>
                    </div>
                    <div class="skeleton-action-item">
                        <div class="skeleton-action-icon"></div>
                        <div class="skeleton-action-label skeleton-bone"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="file_messenger" class="file-overlay" style="display: none;">
            <div class="file-message-card">
                <div class="file-message-icon" id="file_messenger_icon"></div>
                <div class="file-message-text" id="file_messenger_msg"></div>
                <div class="file-message-actions" id="file_messenger_msg_login" style="display: none;">
                    <button class="file-btn primary" type="button" onclick="app.open('/app&listview=login');" i18n="index_b3">Login</button>
                    <button class="file-btn ghost" type="button" onclick="app.open('/app&listview=reg');" i18n="index_b2">Register</button>
                </div>
            </div>
        </div>

        <div id="file_loading_box" class="file-overlay" style="display: none;">
            <div class="file-loading" role="status" aria-live="polite">
                <img src="/img/loading.svg" alt="Loading">
            </div>
        </div>

        <div id="file_box" class="file-content" style="display: none;">
            <section class="file-panel file-info-panel" id="file_info">
                <div class="file-alert" id="wechat_notice" role="alert" style="display: none;" i18n="filepage_mobile_notice">.</div>
                <div class="d-none" id="report_ukey"></div>

                <div class="file-icon">
                    <iconpark-icon name="file-lines" id="file-icon"></iconpark-icon>
                </div>

                <h1 class="file-title" id="filename">.</h1>

                <div class="file-meta">
                    <div class="file-meta-item">
                        <iconpark-icon name="compact-disc"></iconpark-icon>
                        <span id="filesize">.</span>
                    </div>
                    <button class="file-meta-item file-meta-like" id="likes" type="button">
                        <iconpark-icon name="like"></iconpark-icon>
                        <span id="likes_count">0</span>
                    </button>
                    <div class="file-meta-item hs-model">
                        <iconpark-icon name="gauge-circle-bolt"></iconpark-icon>
                        <span class="hs-model-title" i18n="hs_title">.</span>
                    </div>
                    <div class="file-meta-item hot-flag" style="display: none;">
                        <iconpark-icon name="fire" style="color: #ef4444;"></iconpark-icon>
                    </div>
                    <div class="file-meta-item" id="lefttime_show" style="display: none;">
                        <iconpark-icon name="timer"></iconpark-icon>
                        <span id="lefttime">--</span>
                    </div>
                </div>

                <div class="file-nsfw" id="nsfw_alert" style="display: none;">
                    <iconpark-icon name="circle-exclamation"></iconpark-icon>
                    <span i18n="filepage_nsfw_alert">NSFW!</span>
                </div>

                <div class="file-publisher userinfo" style="display: none;">
                    <div class="publisher-avatar">
                        <img class="userinfo_avatar_card_img" src="/img/loading.svg" alt="Avatar">
                    </div>
                    <div class="publisher-details">
                        <div class="publisher-name">
                            <span class="userinfo_nickname userinfo_card_nickname"></span>
                            <span class="userinfo_sd" style="display: none;"></span>
                            <span class="userinfo_pro userinfo_card_pro" style="display: none;">
                                <iconpark-icon name="circle-check"></iconpark-icon>
                            </span>
                        </div>
                        <div class="publisher-intro">
                            <span class="userinfo_card_intro">个人介绍信息</span>
                        </div>
                    </div>
                    <div class="publisher-badge" i18n="filepage_sharer_badge">分享者</div>
                </div>
            </section>

            <section class="file-panel file-action-panel">
                <div class="mobile-footer">
                    <button type="button" class="file-download-btn" id="file_download_btn_fast">
                        <span class="download-progress-fill" id="progress_thread_1"></span>
                        <span class="download-btn-label">
                            <span class="download-btn-text" i18n="file_btn_download_fast">Download</span>
                        </span>
                        <span class="download-btn-status" id="download_progress_container" aria-live="polite" style="display: none;">
                            <span id="download_speed">0 KB/s</span>
                            <span class="status-separator">•</span>
                            <span id="download_progress">0 MB / 0 MB</span>
                        </span>
                    </button>
                </div>

                <div id="file_download_area">
                    <div id="file_op" style="display: none;">
                        <div class="file-actions-grid">
                            <div class="file-action-item file-dropdown">
                                <button class="action-button file-dropdown-toggle" type="button" onclick="fileUI.toggleDropdown(this)">
                                    <span class="action-icon">
                                        <iconpark-icon name="laptop-arrow-down"></iconpark-icon>
                                    </span>
                                    <span class="action-label" id="file_btn_download_opt" i18n="file_btn_download_opt">.</span>
                                </button>
                                <div class="file-dropdown-menu">
                                    <button class="file-dropdown-item btn_copy_downloadurl_for_other" type="button" onclick="fileUI.closeDropdowns();">
                                        <iconpark-icon name="rectangle-terminal" class="fa-fw"></iconpark-icon>
                                        <span i18n="file_btn_download_opt_link">.</span>
                                    </button>
                                    <button class="file-dropdown-item btn_copy_downloadurl_for_curl" type="button" onclick="fileUI.closeDropdowns();">
                                        <iconpark-icon name="rectangle-terminal" class="fa-fw"></iconpark-icon>
                                        <span i18n="file_btn_download_opt_curl">.</span>
                                    </button>
                                    <button class="file-dropdown-item btn_copy_downloadurl_for_wget" type="button" onclick="fileUI.closeDropdowns();">
                                        <iconpark-icon name="rectangle-terminal" class="fa-fw"></iconpark-icon>
                                        <span i18n="file_btn_download_opt_wget">.</span>
                                    </button>
                                </div>
                            </div>

                            <button class="file-action-item" id="file_download_by_qrcode" type="button">
                                <span class="action-icon">
                                    <iconpark-icon name="mobile-signal"></iconpark-icon>
                                </span>
                                <span class="action-label" i18n="file_btn_qr_mobile">.</span>
                            </button>

                            <button class="file-action-item btn_copy_fileurl" id="btn_copy_fileurl" type="button" onclick="filePage.copyShareUrl()">
                                <span class="action-icon" id="btn_copy_fileurl_icon">
                                    <iconpark-icon name="share-all"></iconpark-icon>
                                </span>
                                <span class="action-label" i18n="file_btn_copy">.</span>
                            </button>

                            <button class="file-action-item btn_play" type="button" style="display: none;" onclick="fileUI.openModal('openWithPlayerModal');">
                                <span class="action-icon">
                                    <iconpark-icon name="play"></iconpark-icon>
                                </span>
                                <span class="action-label" i18n="file_btn_play">.</span>
                            </button>

                            <button class="file-action-item" id="btn_add_to_workspace" type="button">
                                <span class="action-icon" id="btn_add_to_workspace_icon">
                                    <iconpark-icon name="file-collection-one"></iconpark-icon>
                                </span>
                                <span class="action-label" i18n="file_btn_collect">.</span>
                            </button>

                            <button class="file-action-item" id="btn_highdownload" type="button">
                                <span class="action-icon">
                                    <iconpark-icon name="rocket-launch"></iconpark-icon>
                                </span>
                                <span class="action-label" i18n="file_btn_upup">.</span>
                            </button>

                            <button class="file-action-item" id="btn_report_file" type="button">
                                <span class="action-icon" style="color: #ef4444;">
                                    <iconpark-icon name="circle-exclamation"></iconpark-icon>
                                </span>
                                <span class="action-label" i18n="file_btn_report">.</span>
                            </button>
                        </div>

                        <div class="file-disclaimer" id="downloadAlert" onclick="fileUI.openModal('downloadAlertModal')" style="display: none;">
                            <iconpark-icon name="triangle-exclamation-solid"></iconpark-icon>
                            <span i18n="da_file">.</span>
                        </div>
                    </div>
                </div>

                <div id="wx_notice" class="file-wx-note" style="display: none;">
                    <h5 i18n="filepage_weixin_notice">.</h5>
                </div>
            </section>
        </div>
        <div id="file_loading" style="display: none;"></div>
    </section>
</div>

<!-- Pure CSS Modals for File Page -->

<!-- QR Code Modal -->
<div class="file-modal" id="qrModal">
    <div class="file-modal-dialog">
        <div class="file-modal-content">
            <div class="file-modal-header">
                <h4 class="file-modal-title">QR Code</h4>
                <button type="button" class="file-modal-close" onclick="fileUI.closeModal('qrModal')">&times;</button>
            </div>
            <div class="file-modal-body">
                <div class="file-qr-code" id="qr_code_url"></div>
            </div>
            <div class="file-modal-footer">
                <button type="button" class="file-modal-btn file-modal-btn-default" onclick="fileUI.closeModal('qrModal')" i18n="model_btn_cancel">取消</button>
            </div>
        </div>
    </div>
</div>

<!-- Report Modal -->
<div class="file-modal" id="reportModal">
    <div class="file-modal-dialog">
        <div class="file-modal-content">
            <div class="file-modal-header">
                <h4 class="file-modal-title" i18n="model_title_report">举报</h4>
                <button type="button" class="file-modal-close" onclick="fileUI.closeModal('reportModal')">&times;</button>
            </div>
            <div class="file-modal-body">
                <select class="file-select" id="report_model">
                    <option value="copyright" i18n="modal_report_reason1" selected>.</option>
                    <option value="nsfw" i18n="modal_report_reason2">.</option>
                    <option value="privacy" i18n="modal_report_reason3">.</option>
                </select>
            </div>
            <div class="file-modal-footer">
                <button type="button" class="file-modal-btn file-modal-btn-success" i18n="modal_report_submit" id="reportbtn" onclick="filePage.report();">提交</button>
                <button type="button" class="file-modal-btn file-modal-btn-default" onclick="fileUI.closeModal('reportModal')" i18n="model_btn_cancel">取消</button>
            </div>
        </div>
    </div>
</div>

<!-- Upup Modal (Download Tips) -->
<div class="file-modal" id="upupModal">
    <div class="file-modal-dialog">
        <div class="file-modal-content">
            <div class="file-modal-header">
                <h4 class="file-modal-title" i18n="model_title_upup">提高下载速度</h4>
                <button type="button" class="file-modal-close" onclick="fileUI.closeModal('upupModal')">&times;</button>
            </div>
            <div class="file-modal-body">
                <h3 i18n="model_upup_t1">方法一：开启浏览器并行下载</h3>
                <p i18n="model_upup_d1_1">.</p>
                <code class="file-code-block">chrome://flags/#enable-parallel-downloading</code>
                <div class="file-img-container">
                    <img class="file-img-thumbnail" src="/img/pd.png" alt="Parallel downloading" />
                </div>
                <hr class="file-hr">
                <h3 i18n="model_upup_t2">方法二：使用下载工具</h3>
                <p i18n="model_upup_d2_1">.</p>
                <hr class="file-hr">
                <h3 i18n="model_upup_t3">方法三：购买会员</h3>
                <p i18n="model_upup_d3_1">.</p>
            </div>
            <div class="file-modal-footer">
                <button type="button" class="file-modal-btn file-modal-btn-default" onclick="fileUI.closeModal('upupModal')" i18n="model_btn_cancel">取消</button>
            </div>
        </div>
    </div>
</div>

<!-- Open With Player Modal -->
<div class="file-modal" id="openWithPlayerModal">
    <div class="file-modal-dialog">
        <div class="file-modal-content">
            <div class="file-modal-header">
                <h4 class="file-modal-title">Player</h4>
                <button type="button" class="file-modal-close" onclick="fileUI.closeModal('openWithPlayerModal')">&times;</button>
            </div>
            <div class="file-modal-body">
                <button class="file-player-btn file-player-btn-primary play_on_browser" style="display: none;">
                    <iconpark-icon name="browser" class="fa-fw"></iconpark-icon>
                    <span>Browser</span>
                </button>
                <button class="file-player-btn file-player-btn-success play_on_potplayer" style="display: none;">
                    <iconpark-icon name="send-backward" class="fa-fw"></iconpark-icon>
                    <span>potplayer</span>
                </button>
                <button class="file-player-btn file-player-btn-success play_on_iina" style="display: none;">
                    <iconpark-icon name="send-backward" class="fa-fw"></iconpark-icon>
                    <span>IINA</span>
                </button>
                <button class="file-player-btn file-player-btn-success play_on_nplayer" style="display: none;">
                    <iconpark-icon name="send-backward" class="fa-fw"></iconpark-icon>
                    <span>nplayer</span>
                </button>
                <button class="file-player-btn file-player-btn-success play_copy_url" style="display: none;">
                    <iconpark-icon name="send-backward" class="fa-fw"></iconpark-icon>
                    <span>Stream URL</span>
                </button>
            </div>
            <div class="file-modal-footer">
                <button type="button" class="file-modal-btn file-modal-btn-default" onclick="fileUI.closeModal('openWithPlayerModal')" i18n="model_btn_cancel">取消</button>
            </div>
        </div>
    </div>
</div>

<!-- Download Alert Modal -->
<div class="file-modal file-modal-lg" id="downloadAlertModal">
    <div class="file-modal-dialog">
        <div class="file-modal-content">
            <div class="file-modal-header">
                <h4 class="file-modal-title">
                    <iconpark-icon name="triangle-exclamation-solid"></iconpark-icon>
                    <span i18n="da_modal_title">下载前提醒</span>
                </h4>
                <button type="button" class="file-modal-close" onclick="fileUI.closeModal('downloadAlertModal')">&times;</button>
            </div>
            <div class="file-modal-body">
                <h2 i18n="da_modal_title_2">下载须知</h2>
                <p i18n="da_modal_p_1">您正在下载钛盘上的文件。请注意，所有文件均由用户上传，可能存在安全风险。下载前请验证文件来源，以保护您的设备安全。</p>
                <h2 i18n="da_modal_title_3">文件发布者</h2>
                <p i18n="da_modal_p_2">若上传者选择公开身份，您将在此页面看到发布者信息（可能仅为网名）。</p>
                <h2 i18n="da_modal_title_4">文件可信度</h2>
                <p i18n="da_modal_p_4">文件可信度取决于您获取链接的渠道：</p>
                <ul>
                    <li i18n="da_modal_li_1">若链接来自可信赖的朋友或知名发布者，一般可以安全下载。</li>
                    <li i18n="da_modal_li_2">若链接来自非官方网站，请谨慎评估文件的可靠性。</li>
                </ul>
            </div>
            <div class="file-modal-footer">
                <button type="button" class="file-modal-btn file-modal-btn-default" onclick="fileUI.closeModal('downloadAlertModal')" i18n="model_btn_cancel">取消</button>
            </div>
        </div>
    </div>
</div>
