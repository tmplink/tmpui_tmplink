<!-- VXUI Framework Entry Template -->
<div class="vx-app" id="vx-app">
    <div class="vx-layout" id="vx-layout">
        <!-- Sidebar Overlay (Mobile) -->
        <div class="vx-sidebar-overlay" onclick="VXUI.closeSidebar()"></div>
        
        <!-- Sidebar -->
        <aside class="vx-sidebar" id="vx-sidebar">
            <div class="vx-sidebar-header">
                <a href="javascript:;" class="vx-sidebar-brand" onclick="if (typeof VXUI !== 'undefined') { VXUI.navigate('filelist', { mrid: 0, view: 'list' }); } else { app.open('/app&listview=room&mrid=0'); }">
                    <img src="/img/ico/logo-new.svg" alt="Logo" class="vx-sidebar-brand-logo">
                    <span class="vx-sidebar-brand-text" data-tpl="product_name">钛盘</span>
                </a>
            </div>
            
            <nav class="vx-sidebar-nav" id="vx-sidebar-nav">
                <!-- Sidebar Skeleton (Preload) -->
                <div id="vx-sidebar-skeleton">
                    <div class="vx-nav-section">
                        <div class="vx-nav-item" style="pointer-events: none; cursor: default;">
                            <div class="vx-skeleton-bone" style="width: 20px; height: 20px; margin-right: 12px; border-radius: 4px;"></div>
                            <div class="vx-skeleton-bone" style="width: 48px; height: 14px; border-radius: 4px;"></div>
                        </div>
                        <div class="vx-nav-item" style="pointer-events: none; cursor: default;">
                            <div class="vx-skeleton-bone" style="width: 20px; height: 20px; margin-right: 12px; border-radius: 4px;"></div>
                            <div class="vx-skeleton-bone" style="width: 32px; height: 14px; border-radius: 4px;"></div>
                        </div>
                        <div class="vx-nav-item" style="pointer-events: none; cursor: default;">
                            <div class="vx-skeleton-bone" style="width: 20px; height: 20px; margin-right: 12px; border-radius: 4px;"></div>
                            <div class="vx-skeleton-bone" style="width: 40px; height: 14px; border-radius: 4px;"></div>
                        </div>
                        <div class="vx-nav-item" style="pointer-events: none; cursor: default;">
                            <div class="vx-skeleton-bone" style="width: 20px; height: 20px; margin-right: 12px; border-radius: 4px;"></div>
                            <div class="vx-skeleton-bone" style="width: 36px; height: 14px; border-radius: 4px;"></div>
                        </div>
                    </div>
                </div>

                <!-- Static navigation - hidden when module has custom sidebar -->
                <div class="vx-nav-static" id="vx-sidebar-static" style="display: none;">
                    <div class="vx-nav-section">
                        <a href="javascript:;" class="vx-nav-item" data-module="filelist" onclick="VXUI.navigate('filelist')">
                            <iconpark-icon name="folder-open-e1ad2j7l"></iconpark-icon>
                            <span class="vx-nav-item-text" data-tpl="nav_files">文件</span>
                        </a>
                        <a href="javascript:;" class="vx-nav-item" data-module="direct" data-auth="logged-in" onclick="VXUI.navigate('direct')">
                            <iconpark-icon name="link"></iconpark-icon>
                            <span class="vx-nav-item-text" data-tpl="nav_direct">直链</span>
                        </a>
                        <a href="javascript:;" class="vx-nav-item" data-module="notes" data-auth="logged-in" onclick="VXUI.navigate('notes')">
                            <iconpark-icon name="memo-pad"></iconpark-icon>
                            <span class="vx-nav-item-text" data-tpl="nav_notes">密记</span>
                        </a>
                        <a href="javascript:;" class="vx-nav-item" data-module="ai" data-auth="logged-in" onclick="VXUI.navigate('ai')">
                            <iconpark-icon name="user-robot"></iconpark-icon>
                            <span class="vx-nav-item-text" data-tpl="nav_ai">助手</span>
                        </a>
                        <a href="/?tmpui_page=/login" class="vx-nav-item" data-auth="logged-out">
                            <iconpark-icon name="user"></iconpark-icon>
                            <span class="vx-nav-item-text" data-tpl="navbar_login">登录</span>
                        </a>
                        <a href="/?tmpui_page=/reg" class="vx-nav-item" data-auth="logged-out">
                            <iconpark-icon name="user-plus"></iconpark-icon>
                            <span class="vx-nav-item-text" data-tpl="navbar_reg">注册</span>
                        </a>
                    </div>
                </div>

                <div class="vx-nav-divider" id="vx-sidebar-divider" style="display: none;"></div>
                
                <!-- Dynamic sidebar content will be inserted here -->
                <div id="vx-sidebar-dynamic"></div>
            </nav>
            
            <!-- Persistent Bottom Menu -->
            <div class="vx-sidebar-bottom-menu" id="vx-sidebar-bottom-real" style="display: none;">
                <div class="vx-nav-section">
                    <a href="javascript:;" class="vx-nav-item" data-module="shop" data-auth="logged-in" onclick="VXUI.navigate('shop')">
                        <iconpark-icon name="bag-shopping"></iconpark-icon>
                        <span class="vx-nav-item-text" data-tpl="nav_shop">商店</span>
                    </a>
                    <a href="javascript:;" class="vx-nav-item" data-module="profile" data-auth="logged-in" onclick="VXUI.navigate('profile')">
                        <iconpark-icon name="user"></iconpark-icon>
                        <span class="vx-nav-item-text" data-tpl="nav_info">信息</span>
                    </a>
                    <a href="javascript:;" class="vx-nav-item" data-module="settings" data-auth="logged-in" onclick="VXUI.navigate('settings')">
                        <iconpark-icon name="gear"></iconpark-icon>
                        <span class="vx-nav-item-text" data-tpl="nav_settings">设定</span>
                    </a>
                </div>
            </div>
            
            <div class="vx-sidebar-footer">
                <!-- Language Switcher (inline expandable) -->
                <div class="vx-lang-switcher" id="vx-lang-dropdown">
                    <a href="javascript:;" class="vx-nav-item" data-action="vx-lang-toggle">
                        <iconpark-icon name="globe"></iconpark-icon>
                        <span class="vx-nav-item-text" id="vx-lang-label">Language / 语言</span>
                        <iconpark-icon name="chevron-down" class="vx-lang-arrow"></iconpark-icon>
                    </a>
                    <div class="vx-lang-options">
                        <div class="vx-lang-option" data-action="vx-lang-set" data-lang="en">English</div>
                        <div class="vx-lang-option" data-action="vx-lang-set" data-lang="cn">简体中文</div>
                        <div class="vx-lang-option" data-action="vx-lang-set" data-lang="hk">繁体中文</div>
                        <div class="vx-lang-option" data-action="vx-lang-set" data-lang="jp">日本語</div>
                    </div>
                </div>

                <a href="https://bbs.tmp.link" class="vx-nav-item" id="vx-community-link" target="_blank" rel="noopener" style="display: none;">
                    <iconpark-icon name="comments"></iconpark-icon>
                    <span class="vx-nav-item-text">交流社区</span>
                </a>

                <a href="javascript:;" class="vx-nav-item" data-auth="logged-in" onclick="if(typeof TL !== 'undefined') TL.logout();">
                    <iconpark-icon name="right-from-bracket"></iconpark-icon>
                    <span class="vx-nav-item-text" data-tpl="nav_logout">退出登录</span>
                </a>
            </div>
        </aside>
        
        <!-- Main Content -->
        <main class="vx-main">
            <!-- Mobile Header -->
            <div class="vx-mobile-header">
                <button class="vx-btn-icon vx-btn-menu" id="vx-mobile-menu" onclick="VXUI.openSidebar()">
                    <iconpark-icon name="bars"></iconpark-icon>
                </button>
                <button class="vx-btn-icon vx-btn-back" id="vx-mobile-back" onclick="VX_FILELIST.goToParent()" style="display: none;">
                    <iconpark-icon name="arrow-circle-left"></iconpark-icon>
                </button>
                <div class="vx-mobile-spacer"></div>
                <div class="vx-btn-group vx-view-toggle vx-mobile-view-toggle" id="vx-mobile-view-toggle" style="display: none;">
                    <button class="vx-btn-icon" id="vx-mobile-view-list" onclick="VX_FILELIST.setViewMode('list')" title="." i18n="vx_view_list" i18n-only="title">
                        <iconpark-icon name="list"></iconpark-icon>
                    </button>
                    <button class="vx-btn-icon" id="vx-mobile-view-album" onclick="VX_FILELIST.setViewMode('album')" title="." i18n="vx_view_album" i18n-only="title">
                        <iconpark-icon name="images"></iconpark-icon>
                    </button>
                </div>
                <button class="vx-btn-icon vx-text-danger" id="vx-mobile-report-btn" onclick="VX_FILELIST.openFolderReportModal()" title="." i18n="file_btn_report" i18n-only="title" style="display: none;">
                    <iconpark-icon name="circle-exclamation"></iconpark-icon>
                </button>
                <div class="vx-btn-group vx-action-toggle vx-mobile-action-toggle" id="vx-mobile-action-toggle" style="display: none;">
                    <button class="vx-btn-icon vx-btn-icon-primary" data-auth="logged-in" data-owner="true" onclick="VX_FILELIST.upload()" title="." i18n="nav_upload" i18n-only="title">
                        <iconpark-icon name="cloud-arrow-up"></iconpark-icon>
                    </button>
                    <button class="vx-btn-icon" data-auth="logged-in" data-owner="true" onclick="VX_FILELIST.showCreateModal()" title="." i18n="model_title_folder_title" i18n-only="title">
                        <iconpark-icon name="folder-plus"></iconpark-icon>
                    </button>
                </div>
            </div>

            <!-- Mobile Folder Title Bar (Filelist) -->
            <div class="vx-mobile-folder-bar" id="vx-fl-mobile-folder-bar" style="display: none;">
                <nav class="vx-mobile-folder-title vx-mobile-breadcrumb" id="vx-fl-mobile-breadcrumb">
                    <a href="javascript:;" onclick="VX_FILELIST.openFolder(0)"><span data-tpl="navbar_meetingroom">桌面</span></a>
                </nav>
            </div>
            
            <!-- Module Container - Modules will be loaded here -->
            <div id="vx-module-container">
                <!-- Header (Preloaded) -->
                <header class="vx-header vx-header-minimal">
                    <div class="vx-header-left">
                        <button class="vx-btn-icon vx-portrait-sidebar-btn" onclick="VXUI.toggleSidebar()">
                            <iconpark-icon name="bars"></iconpark-icon>
                        </button>
                        <nav class="vx-breadcrumb">
                            <a href="javascript:;"><span data-tpl="navbar_meetingroom">桌面</span></a>
                        </nav>
                    </div>
                    
                    <div class="vx-header-right">
                        <div class="vx-btn-group vx-view-toggle">
                            <button class="vx-btn-icon active">
                                <iconpark-icon name="list"></iconpark-icon>
                            </button>
                            <button class="vx-btn-icon">
                                <iconpark-icon name="images"></iconpark-icon>
                            </button>
                        </div>
                        <button class="vx-btn vx-btn-ghost" data-auth="logged-in" data-owner="true">
                            <iconpark-icon name="cloud-arrow-up"></iconpark-icon>
                            <span data-tpl="nav_upload">上传文件</span>
                        </button>
                        <button class="vx-btn vx-btn-ghost" data-auth="logged-in" data-owner="true">
                            <iconpark-icon name="folder-plus"></iconpark-icon>
                            <span data-tpl="model_title_folder_title">新建文件夹</span>
                        </button>
                        <button class="vx-btn vx-btn-ghost">
                            <iconpark-icon name="rotate"></iconpark-icon>
                            <span data-tpl="album_refresh">刷新</span>
                        </button>
                    </div>
                </header>

                <!-- Content -->
                <div class="vx-content vx-content-list" style="padding-top: 0;">
                     <div class="vx-loading" id="vx-fl-loading">
                        <div class="vx-skeleton-list">
                            <div class="vx-skeleton-header">
                                <div class="vx-skeleton-bone vx-skeleton-checkbox"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text" style="width: 150px; flex: inherit;"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text-sm size"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text-date"></div>
                            </div>
                            <div class="vx-skeleton-row">
                                <div class="vx-skeleton-bone vx-skeleton-checkbox"></div>
                                <div class="vx-skeleton-bone vx-skeleton-icon"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text" style="width: 60%"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text-sm size"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text-date"></div>
                            </div>
                            <div class="vx-skeleton-row">
                                <div class="vx-skeleton-bone vx-skeleton-checkbox"></div>
                                <div class="vx-skeleton-bone vx-skeleton-icon"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text" style="width: 45%"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text-sm size"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text-date"></div>
                            </div>
                            <div class="vx-skeleton-row">
                                <div class="vx-skeleton-bone vx-skeleton-checkbox"></div>
                                <div class="vx-skeleton-bone vx-skeleton-icon"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text" style="width: 70%"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text-sm size"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text-date"></div>
                            </div>
                             <div class="vx-skeleton-row">
                                <div class="vx-skeleton-bone vx-skeleton-checkbox"></div>
                                <div class="vx-skeleton-bone vx-skeleton-icon"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text" style="width: 50%"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text-sm size"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text-date"></div>
                            </div>
                             <div class="vx-skeleton-row">
                                <div class="vx-skeleton-bone vx-skeleton-checkbox"></div>
                                <div class="vx-skeleton-bone vx-skeleton-icon"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text" style="width: 55%"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text-sm size"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text-date"></div>
                            </div>
                             <div class="vx-skeleton-row">
                                <div class="vx-skeleton-bone vx-skeleton-checkbox"></div>
                                <div class="vx-skeleton-bone vx-skeleton-icon"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text" style="width: 40%"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text-sm size"></div>
                                <div class="vx-skeleton-bone vx-skeleton-text-date"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Mobile Bottom Bar -->
    <div class="vx-mobile-bar" data-auth="logged-in">
        <button class="vx-mobile-btn" data-module="filelist" onclick="VXUI.navigate('filelist')">
            <iconpark-icon name="folder-open-e1ad2j7l"></iconpark-icon>
            <span data-tpl="nav_files">文件</span>
        </button>
        <button class="vx-mobile-btn" data-module="notes" data-auth="logged-in" onclick="VXUI.navigate('notes')">
            <iconpark-icon name="memo-pad"></iconpark-icon>
            <span data-tpl="nav_notes">密记</span>
        </button>
        <button class="vx-mobile-btn" data-module="ai" data-auth="logged-in" onclick="VXUI.navigate('ai')">
            <iconpark-icon name="user-robot"></iconpark-icon>
            <span data-tpl="nav_ai">助手</span>
        </button>
        <button class="vx-mobile-btn" data-module="direct" data-auth="logged-in" onclick="VXUI.navigate('direct')">
            <iconpark-icon name="link"></iconpark-icon>
            <span data-tpl="nav_direct">直链</span>
        </button>
    </div>
</div>
