<link rel="stylesheet" href="/css/file-mobile-v2.css?v=2">
<script src="/js/core/mobile-file.js?v=1"></script>

<div class="mobile-download-shell">
    <!-- Header -->
    <header class="mobile-header">
        <div class="mobile-brand">
            <a href="/"><img id="top_loggo" src="/img/loading.svg" alt="tmp.link"></a>
        </div>
        <div class="header-actions">
            <div class="dropdown">
                <button class="lang-toggle-minimal" data-toggle="dropdown">
                    <iconpark-icon name="language"></iconpark-icon>
                </button>
                <div class="dropdown-menu dropdown-menu-right shadow-lg" style="border-radius: 16px; border: none;">
                    <a class="dropdown-item" href="javascript:void(0)" onclick="TL.language('cn');">简体中文</a>
                    <a class="dropdown-item" href="javascript:void(0)" onclick="TL.language('hk');">繁体中文</a>
                    <a class="dropdown-item" href="javascript:void(0)" onclick="TL.language('en');">English</a>
                    <a class="dropdown-item" href="javascript:void(0)" onclick="TL.language('jp');">日本語</a>
                </div>
            </div>
        </div>
    </header>

    <!-- Messenger (Login/Error) Overlay -->
    <div id="file_messenger" style="display: none;">
        <div class="messenger-card">
            <div class="messenger-icon" id="file_messenger_icon"></div>
            <div class="messenger-msg" id="file_messenger_msg"></div>
            <div id="file_messenger_msg_login" style="display: none; padding: 0 20px;">
                <button class="btn btn-primary btn-lg btn-block mb-3" style="border-radius: 14px;" onclick="app.open('/app&listview=login');" i18n="index_b3">Login</button>
                <button class="btn btn-light btn-lg btn-block" style="border-radius: 14px;" onclick="app.open('/app&listview=reg');" i18n="index_b2">Register</button>
            </div>
        </div>
    </div>

    <!-- Loading (shown before file details are ready) -->
    <div class="mobile-content" id="file_loading_box">
        <div class="mobile-loading" role="status" aria-live="polite">
            <img class="mobile-loading-icon" src="/img/loading.svg" alt="Loading">
        </div>
    </div>

    <!-- Main Content -->
    <main class="mobile-content" id="file_box" style="display: none;">
        <!-- File Preview -->
        <div class="file-preview-area" id="file_info">
            <div class="file-icon-wrapper">
                <iconpark-icon name="file-lines" id="file-icon"></iconpark-icon>
            </div>
            
            <h1 class="file-title" id="filename">Loading...</h1>
            
            <div class="file-meta-row">
                <span class="meta-item">
                    <span id="filesize">--</span>
                </span>
                <span class="meta-dot"></span>
                <span class="meta-item hs-model">
                    <iconpark-icon name="gauge-circle-bolt"></iconpark-icon>
                    <span class="hs-model-title" i18n="hs_title">Standard</span>
                </span>
                <span class="meta-dot hot-flag" style="display: none;"></span>
                <span class="meta-item hot-flag" style="display: none;">
                    <iconpark-icon name="fire" style="color: #ef4444;"></iconpark-icon>
                </span>
            </div>
            
            <div class="file-meta-row" id="lefttime_show" style="display: none;">
                <iconpark-icon name="timer"></iconpark-icon>
                <span id="lefttime">--</span>
            </div>

            <!-- NSFW Alert -->
            <div id="nsfw_alert" style="display: none;">
                <iconpark-icon name="circle-exclamation"></iconpark-icon>
                <span i18n="filepage_nsfw_alert">NSFW Content</span>
            </div>

            <!-- User Info -->
            <div class="publisher-card userinfo" style="display: none;">
                <div class="publisher-icon">
                    <img class="userinfo_avatar_card_img" src="/img/loading.svg" alt="Avatar">
                </div>
                <div class="publisher-content">
                    <div class="publisher-name-row">
                        <span class="userinfo_nickname userinfo_card_nickname"></span>
                        <span class="userinfo_pro userinfo_card_pro" style="display: none;">
                            <iconpark-icon name="circle-check"></iconpark-icon>
                        </span>
                        <span class="userinfo_sd" style="display: none;"></span>
                    </div>
                    <div class="publisher-intro">
                        <span class="userinfo_card_intro">个人介绍信息</span>
                    </div>
                </div>
                <div class="publisher-badge" i18n="filepage_sharer_badge">分享者</div>
            </div>
        </div>

        <!-- Action Grid (Secondary Actions) -->
        <div class="action-grid" id="file_op">
            <button class="action-item" id="likes" onclick="mobileLikeFile()">
                <div class="action-icon-box">
                    <iconpark-icon name="like"></iconpark-icon>
                </div>
                <span class="action-label" id="likes_count">0</span>
            </button>

            <button class="action-item" id="btn_add_to_workspace_mobile" onclick="mobileAddToWorkspace()">
                <div class="action-icon-box">
                    <iconpark-icon name="folder-plus"></iconpark-icon>
                </div>
                <span class="action-label" i18n="file_btn_collect">Save</span>
            </button>

            <button class="action-item" id="btn_copy_fileurl_mobile" onclick="mobileCopyFileUrl()">
                <div class="action-icon-box">
                    <iconpark-icon name="share-all"></iconpark-icon>
                </div>
                <span class="action-label" i18n="file_btn_copy">Copy</span>
            </button>

            <button class="action-item" id="btn_report_file" onclick="$('#reportModal').modal('show')">
                <div class="action-icon-box" style="color: #ef4444;">
                    <iconpark-icon name="circle-exclamation"></iconpark-icon>
                </div>
                <span class="action-label" i18n="file_btn_report">Report</span>
            </button>
        </div>
        
        <!-- Hidden elements for JS compatibility -->
        <div class="d-none" id="report_ukey"></div>
        <div class="d-none" id="wechat_notice"></div>
        <div class="d-none" id="wx_notice"></div>
        <div class="d-none" id="index_lang"></div>
        <span class="d-none userinfo_avatar"></span>
    </main>

    <!-- Footer / Bottom Sheet -->
    <footer class="mobile-footer" style="display: none;">
        <button type="button" id="file_download_btn_fast">
            <span class="download-progress-fill" id="progress_thread_1"></span>
            <span class="download-btn-label">
                <span class="download-btn-text" i18n="file_btn_download_fast">Download</span>
            </span>
            <span class="download-btn-status" id="download_progress_container" aria-live="polite">
                <span id="download_speed">0 KB/s</span>
                <span class="status-separator">•</span>
                <span id="download_progress">0 MB / 0 MB</span>
            </span>
        </button>
        
        <div class="legal-text" id="downloadAlert" style="display: none;" onclick="$('#downloadAlertModal').modal('show')">
            <span i18n="da_file">Disclaimer: User generated content.</span>
        </div>
    </footer>
</div>
